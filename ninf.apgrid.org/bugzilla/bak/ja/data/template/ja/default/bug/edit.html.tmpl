#------------------------------------------------------------------------
# Compiled template generated by the Template Toolkit version 2.09
#------------------------------------------------------------------------

Template::Document->new({
    METADATA => {
        'modtime' => '1081929522',
        'name' => 'bug/edit.html.tmpl',
    },
    BLOCK => sub {
        my $context = shift || die "template sub called without context\n";
        my $stash   = $context->stash;
        my $output  = '';
        my $error;
        
        eval { BLOCK: {
    $output .=  "<!-- 1.0\@bugzilla.org -->\n";
    $output .=  "\n";
    
    # CAPTURE
    $stash->set('filtered_desc', do {
        my $output = '';
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'short_desc', 0]);
        
        &$filter($output);
    };
    
        $output;
    });
    
    if (!($stash->get('header_done'))) {
    $output .=  $context->process('global/header.html.tmpl', { 'title' => ("Bug " . $stash->get(['bug', 0, 'bug_id', 0]) . " - " . $stash->get(['bug', 0, 'short_desc', 0])), 'h1' => ("Bugzilla Bug " . $stash->get(['bug', 0, 'bug_id', 0])), 'h2' => $stash->get('filtered_desc'), 'header_html' => $stash->get('navigation_links') });
    }
    
    $output .=  "\n";
    $output .=  $context->process('bug/navigate.html.tmpl');
    $output .=  "\n\n<hr>\n\n<form name=\"changeform\" method=\"post\" action=\"process_bug.cgi\">\n\n  <input type=\"hidden\" name=\"delta_ts\" value=\"";
    $output .=  $stash->get(['bug', 0, 'delta_ts', 0]);
    $output .=  "\">\n  <input type=\"hidden\" name=\"longdesclength\" value=\"";
    $output .=  $stash->get(['bug', 0, 'longdesclength', 0]);
    $output .=  "\">\n  <input type=\"hidden\" name=\"id\" value=\"";
    $output .=  $stash->get(['bug', 0, 'bug_id', 0]);
    $output .=  "\">\n\n";
    $output .=  "\n\n  <table cellspacing=\"1\" cellpadding=\"1\" border=\"0\">\n    <tr>      \n      <td align=\"right\">\n        <b>Bug#:</b>\n      </td>\n      <td>\n        <a href=\"";
    $output .=  $stash->get(['Param', [ 'urlbase' ]]);
    $output .=  "show_bug.cgi?id=";
    $output .=  $stash->get(['bug', 0, 'bug_id', 0]);
    $output .=  "\">";
    $output .=  $stash->get(['bug', 0, 'bug_id', 0]);
    $output .=  "</a>\n      </td>\n      \n      <td>&nbsp;</td>\n\n      <td align=\"right\">\n        <b>プラットフォーム:</b>\n      </td>";
    $output .=  $context->process('select', { 'selname' => 'rep_platform' });
    $output .=  "\n      \n      <td align=\"right\">\n        <b>報告者:</b>\n      </td>\n      <td>";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'reporter', 0]);
        
        &$filter($output);
    };
    
    $output .=  "\n      </td>    \n    </tr>\n    \n    <tr>\n      <td align=\"right\">\n        <b>プロダクト:</b>\n      </td>";
    $output .=  $context->process('select', { 'selname' => 'product' });
    $output .=  "\n      \n      <td align=\"right\">\n        <b>OS:</b>\n      </td>";
    $output .=  $context->process('select', { 'selname' => 'op_sys' });
    $output .=  "\n\n      <td align=\"right\">\n        <b>追加&nbsp;CC:</b>\n      </td>\n      <td>\n        <input name=\"newcc\" size=\"30\" value=\"\">\n      </td>\n    </tr>\n\n";
    $output .=  "    \n\n    <tr>\n      <td align=\"right\">\n        <b>\n          <a href=\"describecomponents.cgi?product=";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('url_quote')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'product', 0]);
        
        &$filter($output);
    };
    
    $output .=  "\">\n            コンポーネント</a>:\n        </b>\n      </td>\n      <td>\n        <select name=\"component\">";
    
    # FOREACH 
    do {
        my ($value, $error, $oldloop);
        my $list = $stash->get('component_');
        
        unless (UNIVERSAL::isa($list, 'Template::Iterator')) {
            $list = Template::Config->iterator($list)
                || die $Template::Config::ERROR, "\n"; 
        }
    
        ($value, $error) = $list->get_first();
        eval { $oldloop = $stash->get('loop') };
        $stash->set('loop', $list);
        eval {
    LOOP:   while (! $error) {
                $stash->{'x'} = $value;
    $output .=  "\n            <option value=\"";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get('x');
        
        &$filter($output);
    };
    
    $output .=  "\"";
    if ($stash->get('x') eq $stash->get(['bug', 0, 'component', 0])) {
    $output .=  ' selected';
    }
    
    $output .=  ">";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get('x');
        
        &$filter($output);
    };
    
    $output .=  "\n            </option>";;
                ($value, $error) = $list->get_next();
            }
        };
        $stash->set('loop', $oldloop);
        die $@ if $@;
        $error = 0 if $error && $error eq Template::Constants::STATUS_DONE;
        die $error if $error;
    };
    
    $output .=  "\n        </select>\n      </td>\n\n      <td>&nbsp;</td>\n \n      <td align=\"right\">\n        <b>バージョン:</b>\n      </td>";
    $output .=  $context->process('select', { 'selname' => 'version' });
    $output .=  "\n      \n      <td rowspan=\"4\" align=\"right\" valign=\"top\">\n        <b>CC:</b>\n      </td>\n      <td rowspan=\"4\" valign=\"top\"> ";
    if ($stash->get(['bug', 0, 'cc', 0])) {
    $output .=  "\n        <select name=\"cc\" multiple=\"multiple\" size=\"5\">";
    
    # FOREACH 
    do {
        my ($value, $error, $oldloop);
        my $list = $stash->get(['bug', 0, 'cc', 0]);
        
        unless (UNIVERSAL::isa($list, 'Template::Iterator')) {
            $list = Template::Config->iterator($list)
                || die $Template::Config::ERROR, "\n"; 
        }
    
        ($value, $error) = $list->get_first();
        eval { $oldloop = $stash->get('loop') };
        $stash->set('loop', $list);
        eval {
    LOOP:   while (! $error) {
                $stash->{'c'} = $value;
    $output .=  "\n          <option value=\"";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get('c');
        
        &$filter($output);
    };
    
    $output .=  "\">";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get('c');
        
        &$filter($output);
    };
    
    $output .=  "</option>";;
                ($value, $error) = $list->get_next();
            }
        };
        $stash->set('loop', $oldloop);
        die $@ if $@;
        $error = 0 if $error && $error eq Template::Constants::STATUS_DONE;
        die $error if $error;
    };
    
    $output .=  "\n        </select>\n        <br>\n        <input type=\"checkbox\" name=\"removecc\">選択された CC を削除\n        <br>";
    }
    else {
    $output .=  "\n        <input type=\"hidden\" name=\"cc\" value=\"\">";
    }
    
    $output .=  "\n      </td>\n    </tr>\n    \n    <tr>\n      <td align=\"right\">\n        <b>\n          <a href=\"bug_status.html\">ステータス</a>:\n        </b>\n      </td>\n      <td>";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'bug_status', 0]);
        
        &$filter($output);
    };
    
    $output .=  "</td>      \n      <td>&nbsp;</td>\n      \n      <td align=\"right\">\n        <b><a href=\"bug_status.html#priority\">優先順位</a>:</b>\n      </td>";
    $output .=  $context->process('select', { 'selname' => 'priority' });
    $output .=  "\n    </tr>\n    \n    <tr>\n      <td align=\"right\">\n        <b>\n          <a href=\"bug_status.html\">処理方法</a>:\n        </b>\n      </td>\n      <td>";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'resolution', 0]);
        
        &$filter($output);
    };
    
    $output .=  "</td>      \n      <td>&nbsp;</td>\n      \n      <td align=\"right\">\n        <b><a href=\"bug_status.html#severity\">重要度</a>:</b>\n      </td>";
    $output .=  $context->process('select', { 'selname' => 'bug_severity' });
    $output .=  "\n      \n    </tr>\n    \n    <tr>\n      <td align=\"right\">\n        <b>\n          <a href=\"bug_status.html#assigned_to\">担当者</a>:\n        </b>\n      </td>\n      <td>";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'assigned_to', 0]);
        
        &$filter($output);
    };
    
    $output .=  "</td>\n      <td>&nbsp;</td>\n ";
    if ($stash->get(['Param', [ 'usetargetmilestone' ]]) && $stash->get(['bug', 0, 'target_milestone', 0])) {
    $output .=  "\n        <td align=\"right\">\n          <b>\n            <a href=\"";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'milestoneurl', 0]);
        
        &$filter($output);
    };
    
    $output .=  "\">ターゲットマイルストーン</a>:\n          </b>\n        </td>";
    $output .=  $context->process('select', { 'selname' => 'target_milestone' });
    }
    else {
    $output .=  "\n        <td colspan=\"3\">&nbsp;</td>";
    }
    
    $output .=  "\n    </tr>\n\n";
    $output .=  "\n";
    if ($stash->get(['Param', [ 'useqacontact' ]])) {
    $output .=  "\n     <tr>\n       <td align=\"right\">\n       <b>QA コンタクト:</b>\n       </td>\n       <td colspan=\"7\">\n         <input name=\"qa_contact\" \n                value=\"";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'qa_contact', 0]);
        
        &$filter($output);
    };
    
    $output .=  "\" size=\"60\">\n       </td>\n     </tr>";
    }
    
    $output .=  "\n\n  <tr>\n    <td align=\"right\">\n      <b>";
    if ($stash->get(['bug', 0, 'bug_file_loc', 0])) {
    $output .=  "\n          <a href=\"";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'bug_file_loc', 0]);
        
        &$filter($output);
    };
    
    $output .=  "\">URL</a>:";
    }
    else {
    $output .=  "\n          URL:";
    }
    
    $output .=  "\n      </b>\n    </td>\n    <td colspan=\"7\">\n      <input name=\"bug_file_loc\" \n             value=\"";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'bug_file_loc', 0]);
        
        &$filter($output);
    };
    
    $output .=  "\" size=\"60\">\n    </td>\n  </tr>\n  \n  <tr>\n    <td align=\"right\">\n      <b>要約:</b>\n    </td>\n    <td colspan=\"7\">\n      <input name=\"short_desc\" \n             value=\"";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'short_desc', 0]);
        
        &$filter($output);
    };
    
    $output .=  "\" size=\"60\">\n    </td>\n  </tr>\n";
    if ($stash->get(['Param', [ 'usestatuswhiteboard' ]])) {
    $output .=  " \n    <tr>\n      <td align=\"right\">\n        <b>ホワイトボード:</b>\n      </td>\n      <td colspan=\"7\">\n        <input name=\"status_whiteboard\" \n               value=\"";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'status_whiteboard', 0]);
        
        &$filter($output);
    };
    
    $output .=  "\" size=\"60\">\n      </td>\n    </tr>";
    }
    
    $output .=  "\n";
    if ($stash->get('use_keywords')) {
    $output .=  "\n    <tr>\n      <td align=\"right\">\n        <b>\n          <a href=\"describekeywords.cgi\">キーワード</a>:\n        </b>\n      <td colspan=\"7\">\n        <input name=\"keywords\" \n               value=\"";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'keywords', 0, 'join', [ ', ' ]]);
        
        &$filter($output);
    };
    
    $output .=  "\" size=\"60\">\n      </td>\n    </tr> ";
    }
    
    $output .=  "\n  </table>\n  \n";
    $output .=  "\n";
    $output .=  $context->process('attachment/list.html.tmpl', { 'attachments' => $stash->get(['bug', 0, 'attachments', 0]), 'bugid' => $stash->get(['bug', 0, 'bug_id', 0]) });
    $output .=  "\n\n";
    $output .=  "\n";
    if ($stash->get(['Param', [ 'usedependencies' ]])) {
    $output .=  "\n  <table>\n    <tr>";
    $output .=  $context->process('dependencies', { 'dep' => { 'title' => 'が依存する', 'fieldname' => 'dependson'  } });
    $output .=  "\n      <td rowspan=\"2\">\n        <a href=\"showdependencytree.cgi?id=";
    $output .=  $stash->get(['bug', 0, 'bug_id', 0]);
    $output .=  "\">\n        依存ツリーを表示</a>\n";
    if ($stash->get(['Param', [ 'webdotbase' ]])) {
    $output .=  "  \n          <br>\n          <a href=\"showdependencygraph.cgi?id=";
    $output .=  $stash->get(['bug', 0, 'bug_id', 0]);
    $output .=  "\">\n          依存グラフを表示</a>";
    }
    
    $output .=  "\n      </td>\n    </tr>\n\n    <tr>";
    $output .=  $context->process('dependencies', { 'dep' => { 'title' => 'が妨害する', 'fieldname' => 'blocked'  } });
    $output .=  "\n    </tr>\n  </table>";
    }
    
    $output .=  "\n";
    if ($stash->get('use_votes')) {
    $output .=  "\n  <table>\n    <tr>\n      <th>\n        <a href=\"votehelp.html\">得票数</a>:\n      </th>\n      <td>";
    $output .=  $stash->get(['bug', 0, 'votes', 0]);
    $output .=  "&nbsp;&nbsp;&nbsp;\n        <a href=\"votes.cgi?action=show_bug&amp;bug_id=";
    $output .=  $stash->get(['bug', 0, 'bug_id', 0]);
    $output .=  "\">\n        このバグの投票を見る</a>&nbsp;&nbsp;&nbsp;\n        <a href=\"votes.cgi?action=show_user&amp;bug_id=";
    $output .=  $stash->get(['bug', 0, 'bug_id', 0]);
    $output .=  "\">\n        このバグに投票する</a>\n      </td>\n    </tr>\n  </table>";
    }
    
    $output .=  "\n\n";
    $output .=  "\n\n  <br>\n  <b>追加コメント:</b>\n  <br>\n  <textarea wrap=\"hard\" name=\"comment\" rows=\"10\" cols=\"80\"\n            accesskey=\"c\"></textarea>\n  <br>\n";
    if ($stash->get(['groups', 0, 'size', 0]) > 0) {
    $output .=  "\n    <br>\n    <b>選択されたグループすべてに属するユーザのみがこのバグを閲覧することができます:</b>\n    <br>\n    <font size=\"-1\">(すべてのボックスのチェックを外すと誰でも見ることのできるバグになります)</font>\n    <br>\n    <br>\n";
    
    # FOREACH 
    do {
        my ($value, $error, $oldloop);
        my $list = $stash->get('groups');
        
        unless (UNIVERSAL::isa($list, 'Template::Iterator')) {
            $list = Template::Config->iterator($list)
                || die $Template::Config::ERROR, "\n"; 
        }
    
        ($value, $error) = $list->get_first();
        eval { $oldloop = $stash->get('loop') };
        $stash->set('loop', $list);
        eval {
    LOOP:   while (! $error) {
                $stash->{'group'} = $value;
    $output .=  "\n      &nbsp;&nbsp;&nbsp;&nbsp;\n      <input type=\"checkbox\" name=\"bit-";
    $output .=  $stash->get(['group', 0, 'bit', 0]);
    $output .=  "\" value=\"1\" ";
    if ($stash->get(['group', 0, 'ison', 0])) {
    $output .=  ('' . " checked=\"checked\"");
    }
    
    if (! $stash->get(['group', 0, 'ingroup', 0])) {
    $output .=  ('' . " disabled=\"disabled\"");
    }
    
    $output .=  ">";
    $output .=  $stash->get(['group', 0, 'description', 0]);
    $output .=  "\n      <br>";;
                ($value, $error) = $list->get_next();
            }
        };
        $stash->set('loop', $oldloop);
        die $@ if $@;
        $error = 0 if $error && $error eq Template::Constants::STATUS_DONE;
        die $error if $error;
    };
    
    $output .=  "\n";
    if (! $stash->get(['user', 0, 'inallgroups', 0])) {
    $output .=  "\n      <b>\n        グループのメンバーだけがバグの閲覧許可を変更できます\n        <!--Only members of a group can change the visibility of a bug for that group-->\n      </b>\n    <br>";
    }
    
    $output .=  "\n";
    if ($stash->get(['bug', 0, 'inagroup', 0])) {
    $output .=  "\n      <p>\n        <b>しかし、以下の役割のユーザは、いつでもこのバグを閲覧できます<!--But users in the roles selected below can always view this bug-->:</b>\n        <br>\n        <small>\n          (担当者                                                ";
    if (($stash->get(['Param', [ 'useqacontact' ]]))) {
    $output .=  "\n             と QA コンタクト";
    }
    
    $output .=  "\n          はいつでもバグを閲覧できます。このセクションは、閲覧できるグループが少なくとも一つは指定されていないと効果を示しません。\n          <!--can always see a bug, and this section does not take effect unless the bug is restricted to at least one group.-->)\n        </small>\n      </p>\n\n      <p>\n        <input type=\"checkbox\" name=\"reporter_accessible\" value=\"1\"";
    if ($stash->get(['bug', 0, 'reporter_accessible', 0])) {
    $output .=  ' checked';
    }
    
    $output .=  ">報告者\n        <input type=\"checkbox\" name=\"cclist_accessible\" value=\"1\"";
    if ($stash->get(['bug', 0, 'cclist_accessible', 0])) {
    $output .=  ' checked';
    }
    
    $output .=  ">CC リスト\n      </p>  ";
    }
    
    }
    
    $output .=  "\n\n";
    $output .=  "\n\n  <br>\n  <input type=\"radio\" name=\"knob\" value=\"none\" checked=\"checked\">\n           <b>";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'bug_status', 0]);
        
        &$filter($output);
    };
    
    $output .=  "&nbsp;";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'resolution', 0]);
        
        &$filter($output);
    };
    
    $output .=  "</b> のままにしておく\n  <br>\n";
    $stash->set('knum', 1);
    $output .=  "\n";
    if ($stash->get(['bug', 0, 'bug_status', 0]) eq 'UNCONFIRMED' && $stash->get(['user', 0, 'canconfirm', 0])) {
    $output .=  "\n    <input type=\"radio\" name=\"knob\" value=\"confirm\">\n    バグを承認する (ステータスを <b>NEW</b> にする)\n    <br>";
    $stash->set('knum', $stash->get('knum') + 1);
    }
    
    $output .=  "\n";
    if ($stash->get(['user', 0, 'canedit', 0])) {
    if ($stash->get(['bug', 0, 'isopened', 0])) {
    if ($stash->get(['bug', 0, 'bug_status', 0]) ne 'ASSIGNED' && $stash->get(['user', 0, 'canconfirm', 0])) {
    $output .=  "\n        <input type=\"radio\" name=\"knob\" value=\"accept\">\n        担当者がバグを引き受ける (";
    if ($stash->get(['bug', 0, 'isunconfirmed', 0])) {
    $output .=  'バグを承認し、';
    }
    
    $output .=  "\n        ステータスを <b>ASSIGNED</b> にする)\n        <br>";
    $stash->set('knum', $stash->get('knum') + 1);
    }
    
    $output .=  "\n";
    if ($stash->get(['bug', 0, 'resolution', 0])) {
    $output .=  "\n        <input type=\"radio\" name=\"knob\" value=\"clearresolution\">\n        処理方法を消去する (現在の処理方法\n        <b>";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'resolution', 0]);
        
        &$filter($output);
    };
    
    $output .=  "</b>) を削除する)<br>";
    $stash->set('knum', $stash->get('knum') + 1);
    }
    
    $output .=  "\n\n      <input type=\"radio\" name=\"knob\" value=\"resolve\">\n      バグを解決して、<a href=\"bug_status.html\">処理方法</a>を\n      <select name=\"resolution\" \n              onchange=\"document.changeform.knob[";
    $output .=  $stash->get('knum');
    $output .=  "].checked=true\">";
    
    # FOREACH 
    do {
        my ($value, $error, $oldloop);
        my $list = $stash->get('resolution');
        
        unless (UNIVERSAL::isa($list, 'Template::Iterator')) {
            $list = Template::Config->iterator($list)
                || die $Template::Config::ERROR, "\n"; 
        }
    
        ($value, $error) = $list->get_first();
        eval { $oldloop = $stash->get('loop') };
        $stash->set('loop', $list);
        eval {
    LOOP:   while (! $error) {
                $stash->{'r'} = $value;
    $output .=  "\n        <option value=\"";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get('r');
        
        &$filter($output);
    };
    
    $output .=  "\">";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get('r');
        
        &$filter($output);
    };
    
    $output .=  "</option>";;
                ($value, $error) = $list->get_next();
            }
        };
        $stash->set('loop', $oldloop);
        die $@ if $@;
        $error = 0 if $error && $error eq Template::Constants::STATUS_DONE;
        die $error if $error;
    };
    
    $output .=  "\n      </select> に変更する\n      <br>";
    $stash->set('knum', $stash->get('knum') + 1);
    $output .=  "\n\n      <input type=\"radio\" name=\"knob\" value=\"duplicate\">\n      バグを解決して、bug # \n      <input name=\"dup_id\" size=\"6\" \n             onchange=\"if (this.value != '')\n                       {document.changeform.knob[";
    $output .=  $stash->get('knum');
    $output .=  "].checked=true}\">\n      の重複とする<br>";
    $stash->set('knum', $stash->get('knum') + 1);
    $output .=  "\n\n      <input type=\"radio\" name=\"knob\" value=\"reassign\"> \n      バグを\n      <input name=\"assigned_to\" size=\"32\" \n             onchange=\"if ((this.value != '";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('js')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'assigned_to_email', 0]);
        
        &$filter($output);
    };
    
    $output .=  "') && \n                            (this.value != '')) {\n                         document.changeform.knob[";
    $output .=  $stash->get('knum');
    $output .=  "].checked=true; \n                       }\"  \n             value=\"";
    
    # FILTER
    $output .=  do {
        my $output = '';
        my $filter = $context->filter('html')
                  || $context->throw($context->error);
    
    $output .=  $stash->get(['bug', 0, 'assigned_to_email', 0]);
        
        &$filter($output);
    };
    
    $output .=  "\">\n      に<a href=\"bug_status.html#assigned_to\">再割り当て</A>する<br>";
    if ($stash->get(['bug', 0, 'isunconfirmed', 0]) && $stash->get(['user', 0, 'canconfirm', 0])) {
    $output .=  "\n        &nbsp;&nbsp;&nbsp;&nbsp;<input type=\"checkbox\" name=\"andconfirm\">\n        そしてバグを承認する (ステータスを <b>NEW</b> にする)\n        <br>";
    }
    
    $stash->set('knum', $stash->get('knum') + 1);
    $output .=  "\n\n      <input type=\"radio\" name=\"knob\" value=\"reassignbycomponent\">\n      バグをコンポーネントの初期担当者";
    if ($stash->get('useqacontact')) {
    $output .=  'と QA コンタクト ';
    }
    
    $output .=  "\n      に再割り当てする\n      <br>";
    if ($stash->get(['bug', 0, 'isunconfirmed', 0]) && $stash->get(['user', 0, 'canconfirm', 0])) {
    $output .=  "\n        &nbsp;&nbsp;&nbsp;&nbsp;<input type=\"checkbox\" name=\"compconfirm\">\n        そしてバグを承認する (ステータスを <b>NEW</b> にする)\n        <br>";
    }
    
    $stash->set('knum', $stash->get('knum') + 1);
    }
    else {
    if ($stash->get(['bug', 0, 'resolution', 0]) ne 'MOVED' || ($stash->get(['bug', 0, 'resolution', 0]) eq 'MOVED' && $stash->get(['user', 0, 'canmove', 0]))) {
    $output .=  "  \n        <input type=\"radio\" name=\"knob\" value=\"reopen\"> バグを再開する\n        <br>";
    $stash->set('knum', $stash->get('knum') + 1);
    }
    
    if ($stash->get(['bug', 0, 'bug_status', 0]) eq 'RESOLVED') {
    $output .=  "\n        <input type=\"radio\" name=\"knob\" value=\"verify\">\n        バグを <b>VERIFIED</b> にする<br>";
    $stash->set('knum', $stash->get('knum') + 1);
    }
    
    if ($stash->get(['bug', 0, 'bug_status', 0]) ne 'CLOSED') {
    $output .=  "\n        <input type=\"radio\" name=\"knob\" value=\"close\">\n        バグを <b>CLOSED</b> にする<br>";
    $stash->set('knum', $stash->get('knum') + 1);
    }
    
    }
    
    }
    
    $output .=  "  \n  \n  <input type=\"submit\" value=\"Commit\">\n  <input type=\"hidden\" name=\"form_name\" value=\"process_bug\">\n  <p>\n    <font size=\"+1\">\n      <b>\n        <a href=\"show_activity.cgi?id=";
    $output .=  $stash->get(['bug', 0, 'bug_id', 0]);
    $output .=  "\">バグの動きを見る</a>\n        &nbsp; | &nbsp;\n        <a href=\"long_list.cgi?buglist=";
    $output .=  $stash->get(['bug', 0, 'bug_id', 0]);
    $output .=  "\">印刷用に整形</a>\n      </b>\n    </font>\n";
    if ($stash->get(['user', 0, 'canmove', 0])) {
    $output .=  "\n      &nbsp; <font size=\"+1\"><b> | </b></font> &nbsp;\n      <input type=\"submit\" name=\"action\" \n             value=\"";
    $output .=  $stash->get(['Param', [ 'move-button-text' ]]);
    $output .=  "\">";
    }
    
    $output .=  "\n  </p>  \n</form>\n\n";
    $output .=  "\n\n<table>\n  <tr>\n    <td align=\"left\" nowrap=\"nowrap\">\n      <b>\n        <a name=\"c0\" href=\"#c0\">コメント</a>:\n      </b>\n    </td>\n    <td align=\"right\" width=\"100%\">\n      報告日: ";
    $output .=  $stash->get(['bug', 0, 'creation_ts', 0]);
    $output .=  "\n    </td>\n  </tr>\n</table>\n<hr>\n";
    $output .=  $context->process('bug/comments.html.tmpl', { 'comments' => $stash->get(['bug', 0, 'comments', 0]) });
    $output .=  "\n  \n<hr>\n";
    $output .=  $context->process('bug/navigate.html.tmpl');
    $output .=  "\n\n<br>\n";
    $output .=  $context->process('global/footer.html.tmpl');
    $output .=  "\n\n\n";
    $output .=  "\n";
    $output .=  "\n";
    $output .=  "\n";
    $output .=  "\n\n\n";
    $output .=  "\n";
    $output .=  "\n";
    $output .=  "\n";
    $output .=  "\n";
        } };
        if ($@) {
            $error = $context->catch($@, \$output);
            die $error unless $error->type eq 'return';
        }
    
        return $output;
    },
    DEFBLOCKS => {
        'dependencies' => sub {
            my $context = shift || die "template sub called without context\n";
            my $stash   = $context->stash;
            my $output  = '';
            my $error;
            
            eval { BLOCK: {
        $output .=  "\n  <th align=\"right\">Bug ";
        $output .=  $stash->get(['bug', 0, 'bug_id', 0]);
        $output .=  " ";
        $output .=  $stash->get(['dep', 0, 'title', 0]);
        $output .=  ":</th>\n  <td>";
        
        # FOREACH 
        do {
            my ($value, $error, $oldloop);
            my $list = $stash->get(['bug', 0, $stash->get(['dep', 0, 'fieldname', 0]), 0]);
            
            unless (UNIVERSAL::isa($list, 'Template::Iterator')) {
                $list = Template::Config->iterator($list)
                    || die $Template::Config::ERROR, "\n"; 
            }
        
            ($value, $error) = $list->get_first();
            eval { $oldloop = $stash->get('loop') };
            $stash->set('loop', $list);
            eval {
        LOOP:   while (! $error) {
                    $stash->{'depbug'} = $value;
        $output .=  $stash->get(['GetBugLink', [ $stash->get('depbug'), $stash->get('depbug') ]]);
        $output .=  ' ';;
                    ($value, $error) = $list->get_next();
                }
            };
            $stash->set('loop', $oldloop);
            die $@ if $@;
            $error = 0 if $error && $error eq Template::Constants::STATUS_DONE;
            die $error if $error;
        };
        
        $output .=  "\n  </td>\n  <td>\n    <input name=\"";
        $output .=  $stash->get(['dep', 0, 'fieldname', 0]);
        $output .=  "\" \n           value=\"";
        $output .=  $stash->get(['bug', 0, $stash->get(['dep', 0, 'fieldname', 0]), 0, 'join', [ ', ' ]]);
        $output .=  "\">\n  </td>";
            } };
            if ($@) {
                $error = $context->catch($@, \$output);
                die $error unless $error->type eq 'return';
            }
        
            return $output;
        },
        'select' => sub {
            my $context = shift || die "template sub called without context\n";
            my $stash   = $context->stash;
            my $output  = '';
            my $error;
            
            eval { BLOCK: {
        $output .=  "  \n  <td>\n    <select name=\"";
        $output .=  $stash->get('selname');
        $output .=  "\">";
        
        # FOREACH 
        do {
            my ($value, $error, $oldloop);
            my $list = $stash->get($stash->get('selname'));
            
            unless (UNIVERSAL::isa($list, 'Template::Iterator')) {
                $list = Template::Config->iterator($list)
                    || die $Template::Config::ERROR, "\n"; 
            }
        
            ($value, $error) = $list->get_first();
            eval { $oldloop = $stash->get('loop') };
            $stash->set('loop', $list);
            eval {
        LOOP:   while (! $error) {
                    $stash->{'x'} = $value;
        $output .=  "\n        <option value=\"";
        
        # FILTER
        $output .=  do {
            my $output = '';
            my $filter = $context->filter('html')
                      || $context->throw($context->error);
        
        $output .=  $stash->get('x');
            
            &$filter($output);
        };
        
        $output .=  "\"";
        if ($stash->get('x') eq $stash->get(['bug', 0, $stash->get('selname'), 0])) {
        $output .=  ' selected';
        }
        
        $output .=  ">";
        
        # FILTER
        $output .=  do {
            my $output = '';
            my $filter = $context->filter('html')
                      || $context->throw($context->error);
        
        $output .=  $stash->get('x');
            
            &$filter($output);
        };
        
        $output .=  "\n        </option>";;
                    ($value, $error) = $list->get_next();
                }
            };
            $stash->set('loop', $oldloop);
            die $@ if $@;
            $error = 0 if $error && $error eq Template::Constants::STATUS_DONE;
            die $error if $error;
        };
        
        $output .=  "\n    </select>\n  </td>\n  <td>&nbsp;</td>";
            } };
            if ($@) {
                $error = $context->catch($@, \$output);
                die $error unless $error->type eq 'return';
            }
        
            return $output;
        },
    },
});
